<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Buffer Overflow</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Buffer Overflow</h1><br/><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>						Exemplo Didático</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>O desenvolverdor precisa armazenar o nome do usuário, então ele define uma variável</p><p>nome com um buffer de 16 bytes. (pois ele sabe que os nomes de usuário do seu sistema</p><p>não passam de 16)</p><p><img src="images/252-1.png" alt="images/252-1.png" /></p><p>Alguns exemplos de funções em linguagem C</p><p><span style="color:#33d17a;">gets</span> - Pega o valor inserido pelo usuário e coloca no buffer (nome)</p><p><span style="color:#33d17a;">strcpy</span> - Copia o valor inserido pelo usuário via argumento no buffer (nome)</p><p><span style="color:#33d17a;">scanf</span> - Recebe um valor inserido pelo usuário e coloca no buffer (nome)</p><p></p><p>Nossa stack ficaria similar ao exemplo abaixo:</p><p><img src="images/252-2.png" alt="images/252-2.png" /></p><p></p><p>E se o programa recerber mais dados do que ele espera e não tratar corretamente a entrada de dados?</p><p><img src="images/252-3.png" alt="images/252-3.png" /><ul><li>Agora acontece a condição do Buffer Overflow</li></ul></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>						Buffer Overflow</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>E se o usuário enviar mais dados do que o buffer espera?</p><p><img src="images/252-4.png" alt="images/252-4.png" /></p><p><strong>EIP</strong> - 41414141</p><p>Próximo endereço a ser chamado 41414141 = erro</p><p>O buffer está em verde e o overflow em vermelho<ul><li>Pra que isso não ocorra, ou o desenvolvedor deve usar funções mais seguras, ou</li></ul></p><p>deve fazer uma validação da informação enviada pelo usuário</p><p></p><p>+ Se conseguirmos controlar o <strong>EIP</strong> conseguimos controlar o fluxo de execução do programa,</p><p>desta forma, podemos inserir um <em><strong>shellcode</strong></em> e direcionar o fluxo de execução do programa</p><p>para o nosso shellcode.</p><p></p><p>+ Etapas até o shellcode:</p><p><ul><li>Descobrir se o programa é vulnerável a buffer overflow</li><li>Encontrar a quantidade correta de bytes para atingir o EIP</li><li>Testar o controle do EIP</li><li>Testar bad characters (bad chars)</li><li>Encontrar um bom endereço de retorno</li><li>Gerar um shellcode</li><li>Ganhar Shell</li></ul></p></div>
</body>
</html>
